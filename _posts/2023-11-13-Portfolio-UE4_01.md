---
layout: post
title: ê±·ê¸°ëª¨ì…˜ì„ ë”ìš± ìì—°ìŠ¤ëŸ½ê²Œ í•´ì£¼ëŠ” ë°©ë²•
date: 2023-11-13
category: 
 - portfolio
 - p-UE4
tag:
 - 1|Animation
 - 1|Animation-Modifier
 - 1|AnimNotify
 - 1|Foot-Plant
 - 1|Footstep
 - 1|Sound-Cue
 - 1|Physical-Material
thumbnail: /style/image/portfolio_thumbnails/UE4/Anim_Modifier.png
icon: game
related: 
 - /2023-10-12-UE4-FootIK
---

ë‹¤ìˆ˜ì˜ ì• ë‹ˆë©”ì´ì…˜ì— ì¼ê´„ ì ìš© ê°€ëŠ¥í•œ `Animation Modifier`ë¡œ `Footstep` ê¸°ëŠ¥êµ¬í˜„ ì„±ê³µê¸°
![AnimModifier_](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/16880b6e-52c2-40a8-ab17-0a1f48943f2a)

* content
{:toc}

## ìš”ì•½

- ì£¼ìš” ë¬¸ì œ :  
    ìºë¦­í„° ëª¨ì…˜ ì¤‘ ë°œë°”ë‹¥ì´ ì§€ë©´ì— ë‹¿ëŠ” ì§€ì ì— ì¤„ ìˆ˜ ìˆëŠ” `Footstep Sound`ë“± íš¨ê³¼ì ìš©ì„ ìœ„í•´ ëŒ€ëŸ‰ì˜ ì• ë‹ˆë©”ì´ì…˜ì— ìˆ˜ì‘ì—…ìœ¼ë¡œ Notifyë¥¼ í•˜ë‚˜í•˜ë‚˜ ì¶”ê°€í•˜ëŠ” **ë¹„ìƒì‚°ì  ë‹¨ìˆœë°˜ë³µ ì‘ì—… ì§„í–‰**   
- í•´ê²° ë°©ì•ˆ :  
    `Animation Modifier`ë¡œ ì• ë‹ˆë©”ì´ì…˜ì˜ Footë³¸ì˜ ìµœì € Xê°’ ì‚°ì¶œ, curveì™€ AnimNotifier ìë™ìƒì„±
- ì‹œë„í•œ ë°©ë²• : 
    1. ë°œë°”ë‹¥ì˜ ìœ„ì¹˜ì •ë³´ë¥¼ ì–»ê¸° ìœ„í•´ Root-ì¤‘ì•™ ìœ„ì¹˜ í†µê³¼ ì§€ì  ì‚°ì¶œ  
    2. ë°œë°”ë‹¥ì´ ì§€ë©´ì— ë‹¿ì€ ìƒíƒœì—ë§Œ `FootIK` ì ìš©
- ì´ë£¨ì–´ë‚¸ ì„±ê³¼ :  
    1. ë‹¤ìˆ˜ì˜ ì• ë‹ˆë©”ì´ì…˜ì— ì¼ê´„ì ìœ¼ë¡œ Footstep Notify ì¶”ê°€ê°€ëŠ¥í•˜ì—¬ ëª©í‘œí•œ íš¨ê³¼ ë‹¨ì‹œê°„ì— ì„¤ì •
    2. ì• ë‹ˆë©”ì´ì…˜ê³¼ ë³¸ íŠ¸ëœìŠ¤í¼ì— ëŒ€í•œ ì´í•´  
    3. ì£¼ì–´ì§„ ì—ì…‹ì— ì œí•œëœ ê²°ê³¼ë¬¼ ë³´ë‹¨ ë‚´ ì…ë§›ì— ë§ê²Œ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ê³  ì‹¶ì€ ê°œë°œìš•ì‹¬ ì¶©ì¡±  

<br>  

ì–¸ë¦¬ì–¼ì˜ `FootIK` ìƒì„¸ë°©ë²•ì€ ê´€ë ¨ Postë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”  
> [UE4(BP & C++) FootIK ì ìš©](2023-10-12-UE4-FootIK)

<br>  

---


## âš™ï¸ Animation Modifier
ë°œë°”ë‹¥ì´ ì§€ë©´ì— ë‹¿ëŠ” ì§€ì ì„ `true`ê°’ìœ¼ë¡œ í•˜ì—¬ ë°œì´ ì§€ë©´ì— ë‹¿ëŠ” ìˆœê°„ `FootIK`ì™€ ê°ì¢… ë°œì†Œë¦¬ íš¨ê³¼ ë“±ì„ ì ìš©í•˜ê³ ì Animation Sequenceì—ì„œ Curveë¥¼ ì¶”ê°€í•´ì£¼ì—ˆë‹¤  
![AM_Footsteps](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/014efeac-9aeb-489b-b552-dc204afad251)  

ë‹¤ìˆ˜ì˜ Animationì‘ì—…ì„ ì§„í–‰í•˜ê³ ë‚˜ë‹ˆ ë‹¨ìˆœí•˜ì§€ë§Œ ë°˜ë³µì ì´ê³  ì–‘ì ìœ¼ë¡œ ë„ˆë¬´ ë§ì•„ ë¹„íš¨ìœ¨ì ì¸ ì‘ì—…ìœ¼ë¡œ íŒë‹¨ë˜ì–´ ë°©ë²•ì„ ê²€ìƒ‰ì„ í•´ë³´ì•˜ê³ , [Animation Modifier](https://docs.unrealengine.com/4.26/ko/AnimatingObjects/SkeletalMeshAnimation/AnimModifiers/) [^201] ë¥¼ í†µí•´ ì¼ê´„ì ìœ¼ë¡œ Animationì— Curveì™€ Notifyë¥¼ ì¶”ê°€í•´ì£¼ëŠ” ê¸°ëŠ¥ì„ ì•Œê²Œë˜ì—ˆë‹¤  
[Giuseppe Portellië‹˜ì˜ í¬ìŠ¤íŠ¸](http://www.aclockworkberry.com/automated-foot-sync-markers-using-animation-modifiers-unreal-engine/) [^202] ë¥¼ í†µí•´ Animation Modifierì˜ ê°œë…ê³¼ í™œìš©ì„ ë°°ì› ê³ , [TechAnim Studiosë‹˜ì˜ íŠœí† ë¦¬ì–¼ YouTube ì˜ìƒ](https://www.youtube.com/watch?v=UEcbYBmd-oc) [^203] ì„ í†µí•´ ì ìš©ì‚¬ë¡€ë¥¼ ì°¸ê³  í–ˆë‹¤  

<br>  

### Setting

![Objects](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/f9ae057f-bb06-47c0-b058-6517ecf3156a)

- í•„ìš”í•œ ê°ì²´ë“¤ ì¶”ê°€

| êµ¬ë¶„ | ê°ì²´ëª… | ë‚´ìš© |
| :---: | :---: | :--- |
|Animation Modifier|AM_Footstep|ì…ë ¥ê°’ì— ë”°ë¼ Anim Sequenceì— Anim Curveì™€ Notify ì¶”ê°€|
|User Defined Struct|FFootstep|*Animation Modifier ì…ë ¥ê°’* <br>ìµœì €ì ì„ ì‚°ì¶œí•  ë³¸ì˜ ì´ë¦„ê³¼ ì¶”ê°€í•  Notify, Curveëª…ì¹­, Notify Event í´ë˜ìŠ¤ <br>ì •ë³´ë¥¼ ì „ë‹¬í•  êµ¬ì¡°ì²´<br> (name) BoneName<br> (name) NotifyTrackName<br> (name) CurveName<br> (AnimNotifyClass) NotifyClass|
|User Defined Enum|ERootMotionDirection|*Animation Modifier ì…ë ¥ê°’* <br>RootMotionì˜ ì´ë™ë°©í–¥ ì„¤ì • <br>X-Posë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ë³¸ì˜ íŠ¸ëœìŠ¤í¼ ì¶•ì´ ìƒì´í•œ ê²½ìš° ë³„ë„ ì„¤ì •ê°€ëŠ¥ <br>X-Pos, Y-Pos, Z-Pos, X-Neg, Y-Neg, Z-Neg|
|Anim Notify|AN_Footstep_L<br>AN_Footstep_R|ì§€ì •ëœ ë³¸ì˜ ìµœì €ìœ„ì¹˜ ë„ë‹¬ ì‹œ ë°œë™ ë  íš¨ê³¼ë¥¼ í˜¸ì¶œ í•  Notify í´ë˜ìŠ¤<br> ì–‘ë°œ ë³„ë„ì ìš©ì„ ìœ„í•´ Leftì™€ Right êµ¬ë¶„|

![image](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/8ec6f9b0-d78c-4869-aec5-5b9343e852ef)

- Inputs  
    Animation Sequenceì— AM_Footstep ì ìš© ì‹œ ì„¸ë¶€ì‚¬í•­ ì…ë ¥ ê°’  

| êµ¬ë¶„ | ë³€ìˆ˜ëª… | Default | ë‚´ìš© |
| :---: | :---: | :--- | :--- |
|Array (struct)<br>FFootstep|Footsteps|0 : <br>BoneName `foot_l` <br>NotifyTrackName `FootFX_L` <br>CurveName `LeftFoot` <br>NotifyClass `AN_Footstep_L` <br>1: <br>BoneName `foot_r` <br>NotifyTrackName `FootFX_R` <br>CurveName `RightFoot` <br>NotifyClass `AN_Footstep_R` |ìµœì €ì ì„ ì‚°ì¶œí•  ë³¸ì˜ ì´ë¦„ê³¼ ì¶”ê°€í•  Notify,<br>Curveëª…ì¹­, í˜¸ì¶œí•  Notify Event í´ë˜ìŠ¤ ì •ë³´|
|(enum)<br>ERootMotionDirection|Direction|X-Pos|ì¢Œì¸¡ê¸°ì¤€ ë³¸ì˜ ì¶•ë°©í–¥ ì„¤ì •|
|float|ToleranceRange|5.0f|ìµœì €ì ìœ¼ë¡œ íŒë‹¨í•  ê·¼ì‚¬ê°’ ì˜¤ì°¨ë²”ìœ„|
|Array<br>name|NotifiesToRemove|null|ì´ë¯¸ ì„¤ì •ëœ NotifyTrackì´ ìˆëŠ” ê²½ìš° ì‚­ì œí• <br> Track ì´ë¦„|
|bool|Test|false|Testëª¨ë“œì—¬ë¶€ ì„¤ì • <br>*Testëª¨ë“œ: Notify ì„¤ì • ì—†ì´ Curveì— ì‹¤ì œ<br>ë³¸ì˜ ìœ„ì¹˜ê°’ í‘œê¸°|

- Functions  

| í•¨ìˆ˜ëª… | ë‚´ìš© |
| :---: | :--- |
|ApplyModifier|Animation Modifier ì ìš©ì‹œ OnApply ì´ë²¤íŠ¸ë¡œ í˜¸ì¶œë  í•¨ìˆ˜ <br>ì œê±°í•  NotifyToRemoveê°€ ìˆëŠ” ê²½ìš° ì œê±° í›„ <br>Footstepsë°°ì—´ì˜ ê° ë³¸ ì •ë³´ë§ˆë‹¤ AddCurvesAndNotifiesí•¨ìˆ˜ í˜¸ì¶œ|
|RevertModifier|Animation Modifier ë˜ëŒë¦¬ê¸° ì‹¤í–‰ ì‹œ OnRevert ì´ë²¤íŠ¸ë¡œ í˜¸ì¶œë  í•¨ìˆ˜ <br>ì…ë ¥ëœ NotifyTrackNameê³¼ CurveNameì„ ì‚­ì œí•˜ë©° Modifier ì ìš© ì „ ìƒíƒœë¡œ ì´ˆê¸°í™”|
|AddCurvesAndNotifies|Footstepêµ¬ì¡°ì²´ì˜ ì •ë³´ê¸°ì¤€ìœ¼ë¡œ Curveì™€ Notify Track ìƒì„± ë° <br>ë§¤ Frameë§ˆë‹¤ ë³¸íŠ¸ëœìŠ¤í¼ì˜ ë†’ì´ê°’ì„ êµ¬í•´ ë³¸ì˜ ìµœì €ì ì„ ì‚°ì¶œí•˜ì—¬ Curve Key ì…ë ¥|

<br>  

### ApplyModifier

<iframe width="100%" height="300" src="https://blueprintue.com/render/yl74526s/" scrolling="no" allowfullscreen></iframe>
**Fullscreenë˜ëŠ” Ctrl+ë§ˆìš°ìŠ¤íœ ë¡œ ZoomIn/Out ê°€ëŠ¥*  

1. `NotifiesToRemove`ì— ì…ë ¥í•œ ì‚­ì œí•˜ê³  ì‹¶ì€ Notify Track ì‚­ì œ
    - ì…ë ¥ëœ NotifyTrack ì´ë¦„ì„ [`IsValidAnimNotifyTrackName`](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/Helpers/IsValidAnimNotifyTrackName/) [^221] ë¥¼ í†µí•´ ìœ íš¨ì„± ê²€ì¦
    - ìœ íš¨ì„±í™•ì¸ í›„ [`RemoveAnimationNotifyTrack`](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/AnimationNotifies/RemoveAnimationN-/) [^222] ì„ í†µí•´ NotifyTrack ì‚­ì œ  
    Trackë‚´ì˜ ëª¨ë“  Notify Eventë“¤ì„ ì¼ê´„ ì‚­ì œí•´ì£¼ê¸° ë•Œë¬¸ì— í¸ë¦¬í•˜ë‹¤  
2. ì…ë ¥ëœ `Footsteps` ë°°ì—´ì„ loopí•˜ë©° ê° ìš”ì†Œë§ˆë‹¤ `AddCurvesAndNotifies`í•¨ìˆ˜ í˜¸ì¶œ

<br>  

### Add Curve & Notify Track

<iframe width="100%" height="300" src="https://blueprintue.com/render/bag4n0v2/" scrolling="no" allowfullscreen></iframe>
**Fullscreenë˜ëŠ” Ctrl+ë§ˆìš°ìŠ¤íœ ë¡œ ZoomIn/Out ê°€ëŠ¥*  

1. Footstepsì— ì…ë ¥ëœ ë³¸ì´ë¦„ì˜ ë§ˆì§€ë§‰ ë¬¸ìì— ë”°ë¼ ì™¼ë°œ/ì˜¤ë¥¸ë°œì„ boolë¡œ êµ¬ë¶„
2. Footstepsì— ì…ë ¥í•œ Curveì´ë¦„ê³¼ NotifyTrack  [`AddCurve`](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/Curves/AddCurve/) [^231] ê³¼ [`AddAnimationNotifyTrack`](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/AnimationNotifies/AddAnimationNotifyTrack/) [^232] í•¨ìˆ˜ë¥¼ í†µí•´ ìƒì„±

<br>  

### Set Minimum Foot Height

<iframe width="100%" height="300" src="https://blueprintue.com/render/mt-9uge-/" scrolling="no" allowfullscreen></iframe>  
**Fullscreenë˜ëŠ” Ctrl+ë§ˆìš°ìŠ¤íœ ë¡œ ZoomIn/Out ê°€ëŠ¥*  

- ë¡œì»¬ë³€ìˆ˜

| êµ¬ë¶„ | ë³€ìˆ˜ëª… | Default | ë‚´ìš© |
| :---: | :---: | :---: | :--- |
| Array float | BoneHeightsByFrame |Clear|ê° í”„ë ˆì„ ë‹¹ í•´ë‹¹ ë³¸ì˜ Componentê¸°ì¤€ ìœ„ì¹˜(ë†’ì´)ê°’ì„ ë‹´ì„ ë°°ì—´|
| int32 | CurrentFrameIndex |0|Loopë¥¼ í†µí•´ ì¦ê°€í•  í”„ë ˆì„ ì¸ë±ìŠ¤ |
| transform | AccumulatedTransform |Location(0,0,0)<br>Rotation(0,0,0)<br>Scale(1,1,1)|[`ComposeTransforms`](https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/Kismet/UKismetMathLibrary/ComposeTransforms/) [^241] ì„ í†µí•´<br>Footë³¸ì˜ íŠ¸ëœìŠ¤í¼ì—ì„œ Rootë³¸ ê¹Œì§€ ë³‘í•©ëœ íŠ¸ëœìŠ¤í¼ ì •ë³´|
| float | CurrentHeight |0.0f|Directionê°’ìœ¼ë¡œ ì…ë ¥í•œ ë³¸ì˜ ì¶•ì •ë³´ì— ë”°ë¼<br>í•„ìš”í•œ ì¶•ì˜ ê°’ì„ ìµœì¢… ë†’ì´ë¡œ ì €ì¥|
| float | MinFootHeight|0.0f|BoneHeightsByFrameë°°ì—´ì˜ ê°’ë“¤ ì¤‘ ìµœì†Œê°’|

[`GetBonePoseForFrame`](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/Pose/GetBonePoseforFrame/) [^242] ì„ í†µí•´ ê° í”„ë ˆì„ ë§ˆë‹¤ ë³¸ì˜ Local Transform ì •ë³´ë¥¼ ì¶”ì¶œí•´ Footë³¸ì˜ Locationê°’ì„ ì–»ì„ ìˆ˜ ìˆë‹¤  
ë”°ë¼ì„œ í•´ë‹¹ AnimationSequenceì˜ í”„ë ˆì„ ìˆ˜ ë§Œí¼ For Loopë¥¼ ëŒë ¤ í•„ìš”í•œ Locationê°’ì„ ì–»ì–´ `BoneHeightsByFrame`ë°°ì—´ì— `CurrentFrameIndex` ìˆœìœ¼ë¡œ ì €ì¥í–ˆë‹¤

1. í•„ìš”í•œ ë¡œì»¬ë³€ìˆ˜ë“¤ ì´ˆê¸°í™”, ForLoopë‚´ë¶€ì—ì„œ AccumulatedTransformë¥¼ ì´ˆê¸°ê°’ìœ¼ë¡œ Set
2. FootBoneì˜ Local Transformì„ Componentë¡œ ê³„ì‚°í•˜ê¸° ìœ„í•œ 2ì°¨ Loop ì§„í–‰ ([ìƒì„¸ë‚´ìš© í•˜ë‹¨ ë‚´ìš© ì°¸ê³ ](#ğŸ‘Ÿlocal-â†’-component))
3. 2ì°¨ Loop ì™„ë£Œ í›„ Directionìœ¼ë¡œ ì…ë ¥í•œ ë³¸ì˜ ì¶•ì •ë³´ì— ë”°ë¼ í•„ìš”í•œ ì¶•ì˜ ê°’ Switchë¡œ ì„ íƒ ë° ìµœì¢… ë†’ì´ ê°’ ë°°ì—´ì— ì €ì¥
4. ëª¨ë“  í”„ë ˆì„ ìˆ˜ ë§Œí¼ Loopì™„ë£Œ í›„ BoneHeightsByFrameë°°ì—´ì˜ ìµœì†Œê°’ì„ MinFootHeightë¡œ Set

#### ğŸ‘ŸLocal â†’ Component 
ë³¸ì˜ Transformì„ Local, Component, ë˜ëŠ” WorldìŠ¤í˜ì´ìŠ¤ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜ëŠ” Animationê·¸ë£¹ì— ìˆëŠ” í•¨ìˆ˜ë¼ Animation Modifier ë¸”ë£¨í”„ë¦°íŠ¸ì—ì„  í˜¸ì¶œì„ í•  ìˆ˜ ì—†ë‹¤  
ë”°ë¼ì„œ ë³¸ Transformì„ Local ì—ì„œ Component ìŠ¤í˜ì´ìŠ¤ë¡œ ë³€í™˜í•˜ëŠ” `GetComponentSpaceTransform`ì˜ êµ¬í˜„ ë°©ì‹ì„ ì°¸ê³ í•˜ì—¬ ì§ì ‘ ê³„ì‚°í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë‚¼ ìˆ˜ ìˆì—ˆë‹¤

![LocalAndComponent](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/264c167b-0995-40f8-b2ea-c155b3311d9f)

+ GetComponentSpaceTransform : `\Engine\Source\Runtime\Engine\private\Animation\PoseAsset.cpp`
+ ComposeTransforms í•¨ìˆ˜ ìœ„ì¹˜ : `\Engine\Source\Runtime\Engine\Classes\Kismet\KismetMathLibrary.h`
+ Transorm Multiply ì—°ì‚°ì ìœ„ì¹˜ : `\Engine\Source\Runtime\Core\Public\Math\TransformVectorized.h`

ìƒìœ„ ë³¸ë…¸ë“œì— ëŒ€í•œ ìƒëŒ€ì (Relative) Transformì„ ì°¨ë¡€ë¡œ ë³‘í•©(Compose)ì‹œì¼œì£¼ë©´ì„œ,  
**Footë³¸ì„ ìµœìƒìœ„ ë³¸ì¸ Rootì— ìƒëŒ€ì ì¸ Transformì„ ì‚°ì¶œí•˜ë©° ë³¸ì˜ Component ìŠ¤í˜ì´ìŠ¤ ê¸°ì¤€ Transformì„ êµ¬í•  ìˆ˜ ìˆë‹¤**  

```cpp
FTransform UPoseAsset::GetComponentSpaceTransform(FName BoneName, const TArray<FTransform>& LocalTransforms) const
{
   const FReferenceSkeleton& RefSkel = GetSkeleton()->GetReferenceSkeleton();
   // Init component space transform with identity
   FTransform ComponentSpaceTransform = FTransform::Identity;
   // Start to walk up parent chain until we reach root (ParentIndex == INDEX_NONE)
   int32 BoneIndex = RefSkel.FindBoneIndex(BoneName);
   while (BoneIndex != INDEX_NONE)
   {
      BoneName = RefSkel.GetBoneName(BoneIndex);
      int32 TrackIndex = GetTrackIndexByName(BoneName);
      // If a track for parent, get local space transform from that
      // If not, get from ref pose
      FTransform BoneLocalTM = (TrackIndex != INDEX_NONE) ? LocalTransforms[TrackIndex] : RefSkel.GetRefBonePose()[BoneIndex];
      // Continue to build component space transform
      ComponentSpaceTransform = ComponentSpaceTransform * BoneLocalTM;
      // Now move up to parent
      BoneIndex = RefSkel.GetParentIndex(BoneIndex);
   }
   return ComponentSpaceTransform;
}
```

<details>
<summary> <u>ComposeTransforms (click!)</u></summary>
<pre>
<code>// FTransform * FTransform
//
// When Q = quaternion, S = single scalar scale, and T = translation
// QST(A) = Q(A), S(A), T(A), and QST(B) = Q(B), S(B), T(B)
// QST (AxB) 
//  QST(A) = Q(A)*S(A)*P*-Q(A) + T(A)
//  QST(AxB) = Q(B)*S(B)*QST(A)*-Q(B) + T(B)
//  QST(AxB) = Q(B)*S(B)*[Q(A)*S(A)*P*-Q(A) + T(A)]*-Q(B) + T(B)
//  QST(AxB) = Q(B)*S(B)*Q(A)*S(A)*P*-Q(A)*-Q(B) + Q(B)*S(B)*T(A)*-Q(B) + T(B)
//  QST(AxB) = [Q(B)*Q(A)]*[S(B)*S(A)]*P*-[Q(B)*Q(A)] + Q(B)*S(B)*T(A)*-Q(B) + T(B)
// Q(AxB) = Q(B)*Q(A)
// S(AxB) = S(A)*S(B)
// T(AxB) = Q(B)*S(B)*T(A)*-Q(B) + T(B)
</code>
</pre>
</details>

<br>  

### Add Key & Notify Event  

<iframe width="100%" height="300" src="https://blueprintue.com/render/b_s77kmy/" scrolling="no" allowfullscreen></iframe>
**Fullscreenë˜ëŠ” Ctrl+ë§ˆìš°ìŠ¤íœ ë¡œ ZoomIn/Out ê°€ëŠ¥*  

ê° Frame ë‹¹ Curve Keyê°€ ì…ë ¥ë˜ì–´ì•¼ í•˜ë¯€ë¡œ Animation Sequenceì˜ Frameìˆ˜ë§Œí¼ For Loopë¥¼ ì§„í–‰

- Test Mode  
    ê²°ê³¼ê°’ Testìš©ìœ¼ë¡œ ê° í”„ë ˆì„ ë‹¹ Footë³¸ì˜ ë†’ì´ê°’ì„ Curveì˜ Keyë¡œ ì¶œë ¥í•˜ì—¬ ìœ¡ì•ˆìœ¼ë¡œ ë†’ì´ ë³€í™” í™•ì¸  
    *ì¶•ì´ ë°”ë€Œì–´ìˆëŠ” Skeletonì˜ ê²½ìš° ì˜¤ë¥˜ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆë‹¤*  
    1. [`AddFloatCurveKey`](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/Curves/AddFloatCurveKey/) [^251] ë¥¼ í†µí•´ ì´ë¯¸ ìƒì„±ëœ Curveì— ì§€ì •ëœ ì‹œê°„ì— floatê°’ì„ Keyë¡œ ìƒì„±í•  ìˆ˜ ìˆë‹¤ 
    2. ì‹œê°„ì„ ì…ë ¥í•´ ì¤˜ì•¼ í•˜ì§€ë§Œ Frameì„ ê¸°ì¤€ìœ¼ë¡œ ìœ„ì¹˜ê°’ì„ êµ¬í–ˆê¸° ë•Œë¬¸ì—[`GetTimeatFrame`](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/Helpers/GetTimeatFrame/) [^252] ë¥¼ í†µí•´ Loopë¡œ ëŒê³  ìˆëŠ” `CurrentFrameIndex`ê°’ì„ ì‹œê°„ìœ¼ë¡œ ê³„ì‚°í•´ `AddFloatCurveKey`ì— ì…ë ¥
    3. `BoneHeightsByFrame` ë°°ì—´ì˜ í•´ë‹¹ ìˆœì„œì˜ ê°’ì„ Key valueë¡œ ì…ë ¥

![image](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/818ef21b-d436-46b9-ae55-99dd5c4136ae)

- Add Key & Notify Event  
    Test Modeë¥¼ í†µí•´ ì˜¤ë¥˜ì—¬ë¶€ë¥¼ í™•ì¸í•œ ë’¤ íŠ¹ì´ì‚¬í•­ì´ ì—†ìœ¼ë©´ ì‹¤ì œ í•„ìš”í•œ Keyê°’ê³¼ Notify Event ì¶”ê°€  
    1. boolê°’ê³¼ ê°™ì´ ë°œë°”ë‹¥ì´ ì§€ë©´ì— ë‹¿ì€ ì‹œì ìœ¼ë¡œ íŒë‹¨ ë  ë•Œ trueê°’ì„ ë°˜í™˜ë°›ì„ ìˆ˜ ìˆë„ë¡ ì‚°ì¶œí•œ ìµœì €ë†’ì´ ê°’ê³¼ `ToleranceRange`ë‚´ ê·¼ì‚¬ê°’ë“¤ì„ 1ë¡œ ì¹˜í™˜í•˜ê³  ê·¸ ì™¸ë¥¼ 0ìœ¼ë¡œ ì…ë ¥
    2. ë°œìêµ­ ì†Œë¦¬ë¥¼ ìƒì„±í•´ì£¼ëŠ” Notify Eventë¥¼ ì²«ë²ˆì§¸ true ê°’ ì…ë ¥ ì‹œ ìƒì„±í•´ì£¼ê¸° ìœ„í•´ bool Updatedê°’ì„ trueë¡œ Set
        ë°œë°”ë‹¥ì´ ì§€ë©´ì— ë‹¿ì•„ìˆëŠ” ë™ì•ˆ ë°œìêµ­ ì†Œë¦¬ ì´ë²¤íŠ¸ê°€ ì§€ì†ì ìœ¼ë¡œ í˜¸ì¶œë˜ì–´ ì¤‘ë³µë˜ì§€ ì•Šë„ë¡ ê·¼ì‚¬ê°’ë²”ìœ„ë¥¼ ë²—ì–´ë‚œ Keyê°’ ì…ë ¥ì´ ë˜ê¸° ì „ê¹Œì§€ trueë¡œ ìœ ì§€

<br>  

---
## FootIK í™œìš© ì‚¬ë¡€
![image](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/f7ba062f-024b-4077-870a-e5b5810a2a4b)
ì§€ë©´ì— ë‹¿ì€ ìƒíƒœë¥¼ 1(true)ë¡œ ë°˜í™˜ë°›ëŠ” Curveë¥¼ FootIK ì ìš© ì‹œ ë³¸IK íŠ¸ëœìŠ¤í¼ì˜ Alphaê°’ì— ì…ë ¥ë˜ë„ë¡ êµ¬ì„±í•´ë³´ì•˜ë‹¤  

- ì¥ì  : ëª¨ë“  ëª¨ì…˜ì— FootIKë¥¼ ì ìš©í•œ ë’¤ ì¼ë¶€ ìƒíƒœì— ë”°ë¼ boolì ìš©ì„ í•  í•„ìš” ì—†ì´ ì‹¤ì œ ë°œë°”ë‹¥ì´ ì§€ë©´ì— ë‹¿ëŠ” ì‹œì ì—ë§Œ FootIKê°€ ì ìš©ë˜ë„ë¡ í•  ìˆ˜ ìˆìŒ
- ë‹¨ì  : ë°œë°”ë‹¥ì´ ì§€ë©´ì— ë‹¿ëŠ” ì‹œì ê³¼ ì•„ë‹Œ ì‹œì ì˜ ë³€í™˜ì´ ê¸‰ê²©í•˜ì—¬ ë³´ê°„ì´ ì ìš©ë˜ì§€ ì•Šì•„ ë¬´ë¦ì´ êµ¬ë¶€ëŸ¬ì§€ëŠ” ìƒí™©ì— ëœê·¸ëŸ­ ê±°ë¦¬ëŠ” ê²ƒê³¼ ê°™ì´ ë¶€ìì—°ìŠ¤ëŸ¬ì›Œ ë³´ì„

![FootIK_Diff](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/2345b4ca-9917-43f0-9eea-617cd6024bf8)

ë³´ê°„ì ìš©ì´ ë˜ì§€ ì•Šì•„ ì›€ì§ì„ì´ ë§¤ë„ëŸ½ì§€ ëª»í•œ ëª¨ìŠµì´ ë§Œì¡±ìŠ¤ëŸ½ì§€ ì•Šì•„ Curveê°’ì„ FootIKì— í™œìš©í•˜ì§€ ì•Šê¸°ë¡œ í–ˆë‹¤  

<br>  

---
## ğŸ”Š Footstep Sound
<iframe width="100%" height="300" src="https://blueprintue.com/render/4ri0lyn5/" scrolling="no" allowfullscreen></iframe>
**Fullscreenë˜ëŠ” Ctrl+ë§ˆìš°ìŠ¤íœ ë¡œ ZoomIn/Out ê°€ëŠ¥*  

`Footstep` Notify Event í˜¸ì¶œ ì‹œ [`SpawnSoundatLocation`](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/Audio/SpawnSoundatLocation/) [^301] ì„ í†µí•´ ì†Œë¦¬ë¥¼ ë‚¼ ìˆ˜ ìˆë‹¤  
ìŒí–¥ íš¨ê³¼ë¥¼ ì¡°ê¸ˆ ë” ìì—°ìŠ¤ëŸ½ê²Œ ì—°ì¶œí•  ìˆ˜ ìˆë„ë¡ ì§€ë©´ì˜ Physical Materialì— ë”°ë¼ ì ì ˆí•œ ì†Œë¦¬ë¥¼ ë‚¼ ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” Sound Cueì™€ Sound Attenuationì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ë³´ì•˜ë‹¤  

1. Character Meshì˜ World Locationì„ Startì§€ì ìœ¼ë¡œ, Meshì˜ í•˜ë‹¨ìœ¼ë¡œ 100ë§Œí¼ ë–¨ì–´ì§„ ì§€ì ì„ Endë¡œ LineTraceë¥¼ ì¶”ì í•´ ì¶©ëŒí•œ ê°œì²´ì˜ Physical Material ì •ë³´ í™•ì¸
2. Notify ë¡œì»¬ ë³€ìˆ˜ë¡œ ì§€ì •í•œ ì§€ë©´ Materialì´ë¦„ string ë°°ì—´ì˜ ê°’ì„ ì¡°íšŒí•´ í•´ë‹¹ ì´ë¦„ê³¼ ì¼ì¹˜í•  ê²½ìš° í•´ë‹¹ ì •ë³´ë¥¼ paramìœ¼ë¡œí•˜ì—¬ SoundCueì—ì„œ í•´ë‹¹ë˜ëŠ” ì†Œë¦¬ë¥¼ ì¶œë ¥

**ìŒì›íŒŒì¼ì€ ìŒì› íŒë§¤ ì‚¬ì´íŠ¸ [Sonniss](https://sonniss.com/gameaudiogdc) [^302] ì—ì„œ GDCê°œìµœê¸°ë…ìœ¼ë¡œ ë¬´ë£Œ ë°°í¬ì¤‘ì¸ íŒŒì¼ë“¤ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤*

![SoundAttenuation](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/5b49eb88-d0f7-4be1-a71c-d1b1dd83981a)
### Setting

![FootstepSoundObjects](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/9373648a-df25-415d-8526-294fe1112669)

- í•„ìš”í•œ ê°ì²´ë“¤ ì¶”ê°€  

| êµ¬ë¶„ | ê°ì²´ëª… | ë‚´ìš© |
| :---: | :---: | :--- |
|SoundCue|SC_FootstepCue|ë‹¤ìˆ˜ì˜ SoundíŒŒì¼ë“¤ì„ ê´€ë¦¬<br>Physical Material ë“±ê³¼ ê°™ì€ ìš”ì†Œë“¤ì„ paramê°’ìœ¼ë¡œ ë°›ì„ ìˆ˜ ìˆì–´<br>ìƒí™©ì— ë”°ë¼ ì ì ˆí•œ SoundíŒŒì¼ì„ ì¶œë ¥í•  ìˆ˜ ìˆê²Œ í•´ì¤Œ|
|SoundAttenuation|SA_FootstepAttenuation|ê±°ë¦¬, êµ¬ê°„ ë“± ìƒí™©ì— ë”°ë¼ ì†Œë¦¬ì˜ ê°ì‡ ê¸°ëŠ¥ì„ ì ìš©í•  ìˆ˜ ìˆìŒ|
|PhysicalMaterial|PM_Concrete<br>PM_Grass<br>PM_Ground<br>PM_Snow<br>PM_Wooden|ì§€ë©´ì˜ ì§ˆê°ì— ë”°ë¼ ìƒì´í•œ ì†Œë¦¬ë¥¼ ë‚¼ ìˆ˜ ìˆë„ë¡<br>ì§€ë©´ Meshì— ì…í Physical Material íŒŒì¼ ìƒì„±í•˜ì—¬ ì§€ë©´ Meshì— Set|

### Sound Cue

![image](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/6c0a9fee-1a54-4c2e-af3c-18b01d7fb0f7)

1. ìì—°ìŠ¤ëŸ¬ì›€ì„ ìœ„í•´ ì¡°ê¸ˆì”© ë‹¤ë¥¸ ì†Œë¦¬ë¥¼ Randomìœ¼ë¡œ ì¶œë ¥í•˜ë„ë¡ ê°™ì€ Physical Materialì´ë”ë¼ë„ ì—¬ëŸ¬ SoundíŒŒì¼ì„ ì¶”ê°€í–ˆë‹¤
2. í•´ë‹¹ë˜ëŠ” Physical Materialì„ paramì„ ë°›ì•˜ì„ ë•Œ Switchë¡œ í•´ë‹¹ ê°’ ì¶œë ¥

### Sound Attenuation

![AttenuationRange](https://github.com/ssonsonya/ssonsonya.github.io/assets/116151781/0221d829-870e-40da-bcd5-69b0c2ca3e09)  

[Sound Attenuation](https://docs.unrealengine.com/4.27/en-US/WorkingWithAudio/DistanceModelAttenuation/) [^331]ì„ í†µí•´ ìŒì›ì˜ ë°œìƒì§€ì ì—ì„œë¶€í„°ì˜ ê±°ë¦¬ì— ë”°ë¼ ì†Œë¦¬ê°€ í¬ê³  ì‘ê²Œ ë“¤ë¦¬ëŠ” íš¨ê³¼ë¥¼ ë„£ì–´ì£¼ì—ˆë‹¤

<br>

---
## ìƒê°ì •ë¦¬

> ë‚˜ì—ê²Œ ê°€ì¥ í•„ìš”í•œ ê²ƒì€ ë” ë§ì€ ê²½í—˜ì´ê³  ê°€ì¥ í° ìì‚°ì´ ë  ê²ƒì´ë‹¤  
ì´ˆê¸° FootIKë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ Animation Modifier ì—°êµ¬í–ˆìœ¼ë‚˜, Curveê°’ì„ í†µí•œ FootIKë¥¼ ì ìš©ì´ ë¶€ìì—°ìŠ¤ëŸ¬ìš´ ê²°ê³¼ë¡œ Animation Modifierë¥¼ í™œìš©í•˜ì§€ ëª»í•˜ê²Œ ë˜ì–´ ì•„ì‰¬ì› ë‹¤  
ì´í›„ ìºë¦­í„° ëª¨ì…˜ì— ìˆì–´ ë°œë°”ë‹¥ì´ ì§€ë©´ì— ë‹¿ëŠ” ì§€ì ì„ í™œìš©í•´ ë‹¤ì–‘í•œ íš¨ê³¼ë¥¼ ë„£ì„ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆê³ , ì—¬ëŸ¬ ê²Œì„ê°œë°œ ë¸”ë¡œê·¸ ê¸€ê³¼ ìœ íŠœë¸Œ íŠœí† ë¦¬ì–¼ì„ ê²€ìƒ‰í•´ ë‹¤ë“¬ì–´ ë‚˜ê°€ ì›í•˜ëŠ” íš¨ê³¼ë¥¼ ë§Œë“¤ ìˆ˜ ìˆê²Œë˜ì–´ ë§¤ìš° ë¿Œë“¯í•˜ë‹¤  

<br>

---
## Reference

[^201]: [Unreal Engine. Unreal Engine Documentation. Animation Modifiers](https://docs.unrealengine.com/4.26/ko/AnimatingObjects/SkeletalMeshAnimation/AnimModifiers/)  
[^202]: [Giuseppe Portelli(2017.11.1). A clockwork berry. Automated foot sync markers using animation modifiers in Unreal Engine](http://www.aclockworkberry.com/automated-foot-sync-markers-using-animation-modifiers-unreal-engine/)  
[^203]: [TechAnim Studios(2020.08.15). YouTube. UE4 Animation Modifier-Automated Foot Sync Markers-#UE4#UE4Tuts](https://www.youtube.com/watch?v=UEcbYBmd-oc)  

[^221]: [Unreal Engine. Unreal Engine Documentation. IsValidAnimNotifyTrackName](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/Helpers/IsValidAnimNotifyTrackName/)  
[^222]: [Unreal Engine. Unreal Engine Documentation. RemoveAnimationNotifyTrack](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/AnimationNotifies/RemoveAnimationN-/)  

[^231]: [Unreal Engine. Unreal Engine Documentation. AddCurve](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/Curves/AddCurve/)  
[^232]: [Unreal Engine. Unreal Engine Documentation. AddAnimationNotifyTrack](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/AnimationNotifies/AddAnimationNotifyTrack/)  

[^241]: [Unreal Engine. Unreal Engine Documentation. Compose Transforms](https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/Kismet/UKismetMathLibrary/ComposeTransforms/)  
[^242]: [Unreal Engine. Unreal Engine Documentation. Get Bone Pose for Frame](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/Pose/GetBonePoseforFrame/)  

[^251]: [Unreal Engine. Unreal Engine Documentation. AddFloatCurveKey](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/Curves/AddFloatCurveKey/)  
[^252]: [Unreal Engine. Unreal Engine Documentation. GetTimeatFrame](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/AnimationBlueprintLibrary/Helpers/GetTimeatFrame/)  

[^301]: [Unreal Engine. Unreal Engine Documentation. SpawnSoundatLocation](https://docs.unrealengine.com/4.26/en-US/BlueprintAPI/Audio/SpawnSoundatLocation/)  
[^302]: [Sonniss. Sonniss. Royalty Free Sound Effects Archive: GameAudioGDC](https://sonniss.com/gameaudiogdc)  

[^331]: [Unreal Engine. Unreal Engine Documentation. SoundAttenuation](https://docs.unrealengine.com/4.27/en-US/WorkingWithAudio/DistanceModelAttenuation/)